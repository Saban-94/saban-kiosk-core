<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>SikaOS - Master Loader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body{background:#f0f2f5; font-family:sans-serif;}</style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-10">

    <div class="bg-white p-10 rounded-2xl shadow-xl w-full max-w-2xl text-center">
        <h1 class="text-3xl font-black text-gray-800 mb-2">ğŸ’¾ SikaOS Loader</h1>
        <p class="text-gray-500 mb-8">×˜×¢×™× ×ª ××¡×“ × ×ª×•× ×™× ×××•×—×“×ª</p>

        <div id="status" class="bg-gray-900 text-green-400 font-mono text-left text-sm p-4 rounded-lg h-48 overflow-y-auto mb-8 dir-ltr">
            > Ready.<br>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div class="space-y-2">
                <h3 class="font-bold text-gray-700 border-b pb-1">×§×˜×œ×•×’ ××•×¦×¨×™×</h3>
                <button onclick="runUpload('products', window.sikaProductsFull, 'Sika')" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded text-sm">
                    ×˜×¢×Ÿ Sika (50)
                </button>
                <button onclick="runUpload('products', window.thermokirProducts, 'Thermokir')" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded text-sm">
                    ×˜×¢×Ÿ ×ª×¨××•×§×™×¨ (50)
                </button>
                <button onclick="runUpload('products', window.mrfixProducts, 'Mr. Fix')" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm">
                    ×˜×¢×Ÿ ×›×¨××™×ª (50)
                </button>
            </div>

            <div class="space-y-2">
                <h3 class="font-bold text-gray-700 border-b pb-1">××•×— AI</h3>
                <button onclick="runUpload('chat_rules', window.sikaSoul, 'Sika Brain')" class="w-full bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-4 rounded text-sm">
                    ×˜×¢×Ÿ ××•×— Sika
                </button>
                <button onclick="runUpload('chat_rules', window.thermokirSoul, 'Thermokir Brain')" class="w-full bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-4 rounded text-sm">
                    ×˜×¢×Ÿ ××•×— ×ª×¨××•×§×™×¨
                </button>
                <button onclick="runUpload('chat_rules', window.mrfixSoul, 'Mr. Fix Brain')" class="w-full bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-4 rounded text-sm">
                    ×˜×¢×Ÿ ××•×— ×›×¨××™×ª
                </button>
            </div>
        </div>
    </div>

    <script src="js/products-seed.js"></script>
    <script src="js/thermokir-seed.js"></script>
    <script src="js/mrfix-seed.js"></script>
    <script src="js/sika-soul-50.js"></script>
    <script src="js/thermokir-soul.js"></script>
    <script src="js/mrfix-soul.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        // ×”×’×“×¨×” ×™×©×™×¨×” ×œ×× ×™×¢×ª ×©×’×™××•×ª ×™×™×¦×•×
        const firebaseConfig = {
          apiKey: "AIzaSyDZuI7AaDZVteUhUT_eIVCR5SIdU0jhqUg",
          authDomain: "saban-kiosk-core.firebaseapp.com",
          projectId: "saban-kiosk-core",
          storageBucket: "saban-kiosk-core.firebasestorage.app",
          messagingSenderId: "866976260818",
          appId: "1:866976260818:web:0e3ec12df72291c77f430b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const logEl = document.getElementById('status');

        function log(msg) {
            logEl.innerHTML += `> ${msg}<br>`;
            logEl.scrollTop = logEl.scrollHeight;
        }

        // ×—×©×™×¤×ª ×”×¤×•× ×§×¦×™×” ×œ-Window ×›×“×™ ×©×”×›×¤×ª×•×¨×™× ×™×¢×‘×“×•
        window.runUpload = async (colName, data, source) => {
            if (!data) {
                log(`âŒ ×©×’×™××”: ×”× ×ª×•× ×™× ×©×œ ${source} ×œ× × ××¦××•. ×‘×“×•×§ ××ª ×§×•×‘×¥ ×”-JS.`);
                return;
            }

            log(`â³ ××ª×—×™×œ ×œ×˜×¢×•×Ÿ ${data.length} ×¤×¨×™×˜×™× ×-${source}...`);
            let count = 0;
            
            for (const item of data) {
                try {
                    // ×”×•×¡×¤×ª ××•×ª×’ ××•×˜×•××˜×™×ª ×× ×—×¡×¨
                    if(colName === 'products' && !item.brand) item.brand = source;
                    
                    await addDoc(collection(db, colName), item);
                    count++;
                } catch (e) {
                    console.error(e);
                    log(`âŒ ×©×’×™××” ×‘×¤×¨×™×˜: ${item.name || item.trigger}`);
                }
            }
            log(`âœ… ×”×¦×œ×—×”! ${count} ×¤×¨×™×˜×™× × ×˜×¢× ×• ×œ-${colName}.`);
        };
    </script>
</body>
</html>
