<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saban Pro Kiosk - Ultimate Fixed</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* --- BRANDING --- */
        :root {
            --sika-yellow: #FFC500;
            --sika-red: #E3000F;
            --sika-black: #111111;
            --glass-bg: rgba(255, 255, 255, 0.98);
        }
        body { font-family: 'Heebo', sans-serif; background: #f0f2f5; overflow: hidden; user-select: none; }

        /* --- SIKA AI ROBOT WRAPPER --- */
        #sikaAiWrapper {
            position: fixed;
            z-index: 9999;
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            pointer-events: none; /*   住 爪转 住 */
        }

        /* --- 爪 专 (States) --- */

        /* 1. 爪 驻 (专) */
        .state-corner {
            bottom: -30px;
            right: -30px;
            width: 250px;
            height: 250px;
        }
        .state-corner .robot-character {
            cursor: pointer;
            pointer-events: auto;
        }
        .state-corner:hover { transform: scale(1.05); }

        /* 2. 爪 驻住  ( 专) */
        .state-lead {
            bottom: 50%;
            right: 50%;
            transform: translate(50%, 50%); /* 专 */
            width: 0; height: 0; /* Wrapper  转驻住 拽,  拽 住转  */
        }
        /* 爪  - 专 注  ,  专 */
        .state-lead .robot-character {
            position: absolute;
            bottom: -150px;
            right: -120px;
            width: 200px;
            opacity: 0.2; /* 砖砖 专拽注 */
            pointer-events: none;
        }

        /* 3. 爪 爪' 驻注 (转拽 ) */
        .state-chat-active {
            bottom: 50%;
            right: 50%;
            transform: translate(50%, 50%); /* Wrapper 转 专 住 */
            width: 0; height: 0;
        }
        
        /* 拽 专 爪' - 爪抓 爪 */
        .state-chat-active .robot-character {
            position: absolute;
            bottom: -250px; /*  转 */
            right: 220px;    /*  转 砖  */
            width: 180px;    /* 拽 注 */
            opacity: 1;
            transition: 0.5s;
        }

        /* --- 转 (转) --- */
        .robot-character {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
            transition: all 0.5s;
        }
        .breathing-effect { animation: breathe 4s ease-in-out infinite; }
        @keyframes breathe {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.02); }
        }

        /* ---  (Window) --- */
        #aiWindow {
            position: absolute; /* 住转 -Wrapper 砖专 */
            background: var(--glass-bg);
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border: 4px solid var(--sika-yellow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            
            /* 爪 转转 (住转专 驻) */
            opacity: 0;
            transform: scale(0);
            pointer-events: auto; /*  砖驻砖专  拽 */
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* 注爪  爪  */
        .state-lead #aiWindow {
            width: 400px;
            height: auto;
            /* 专 住 */
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            opacity: 1;
        }

        /* 注爪  爪 爪' (转拽) */
        .state-chat-active #aiWindow {
            width: 500px;
            height: 600px;
            /* 转 专 - 砖 转 注! */
            max-width: 90vw;  /* 拽住 90% 专 住 */
            max-height: 80vh; /* 拽住 80%  住 */
            
            /* 专 */
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            opacity: 1;
        }

        /* --- UI COMPONENTS --- */
        .sidebar-btn { @apply flex flex-col items-center justify-center p-4 text-gray-400 rounded-xl transition-all duration-300 hover:bg-white hover:text-black hover:shadow-md; }
        .sidebar-btn.active { @apply bg-[#111] text-[#FFC500] shadow-lg transform scale-105; }
        
        .product-card { @apply bg-white rounded-3xl overflow-hidden shadow-sm hover:shadow-2xl transition-all duration-300 border border-transparent hover:border-[#2563eb] h-80 flex flex-col cursor-pointer hover:-translate-y-2; }
        
        .cat-btn { @apply flex items-center gap-2 px-6 py-3 rounded-full bg-white border border-gray-200 font-bold text-gray-600 transition hover:border-[#E3000F] hover:text-[#E3000F]; }
        .cat-btn.active { @apply bg-[#111] text-white border-[#111]; }

        /* Modal Overlay */
        .modal-overlay { @apply fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center backdrop-blur-sm transition-opacity duration-300; }
        .modal-overlay.open { @apply flex animate-fade-in; }
        
        .tech-badge { @apply bg-gray-50 p-2 rounded-lg text-center border border-gray-100 flex flex-col items-center gap-1; }
        .tech-val { @apply font-bold text-gray-800 text-sm; }
        .tech-label { @apply text-[10px] text-gray-400 font-bold uppercase; }

        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="flex h-screen w-screen">

    <nav class="w-32 bg-white h-full flex flex-col items-center py-8 shadow-2xl z-40 relative">
        <div class="mb-10 w-20 h-20 bg-gray-100 rounded-2xl flex items-center justify-center p-2">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/62/Sika_AG_logo.svg/1200px-Sika_AG_logo.svg.png" class="w-full h-full object-contain">
        </div>
        <button onclick="switchTab('catalog')" id="btn-catalog" class="sidebar-btn active mb-4"><i data-lucide="layout-grid" size="32"></i><span class="text-xs font-bold mt-1">拽</span></button>
        <button onclick="switchTab('calculator')" id="btn-calculator" class="sidebar-btn"><i data-lucide="calculator" size="32"></i><span class="text-xs font-bold mt-1">砖</span></button>
        <div class="mt-auto opacity-40 hover:opacity-100 transition"><button class="sidebar-btn"><i data-lucide="settings" size="24"></i></button></div>
    </nav>

    <main class="flex-1 flex flex-col relative h-full overflow-hidden p-8">
        <header class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-4xl font-black text-gray-900">Saban <span class="text-[#E3000F]">Center</span></h1>
                <p class="text-gray-400 font-medium">专 拽爪注  砖驻抓</p>
            </div>
            <div class="relative w-[500px]">
                <input id="searchInput" oninput="filterProducts()" type="text" placeholder="驻砖 爪专, 驻转专  注..." class="w-full bg-white p-5 pr-14 rounded-2xl shadow-sm focus:outline-none focus:ring-2 focus:ring-[#E3000F] text-lg font-medium">
                <i data-lucide="search" class="absolute right-5 top-5 text-gray-400" size="24"></i>
            </div>
        </header>

        <div class="flex gap-4 mb-8 overflow-x-auto pb-2 no-scrollbar">
            <button class="cat-btn active"></button>
            <button class="cat-btn"><i data-lucide="droplets" size="18"></i> </button>
            <button class="cat-btn"><i data-lucide="layers" size="18"></i> 专爪祝</button>
            <button class="cat-btn"><i data-lucide="hammer" size="18"></i> </button>
            <button class="cat-btn"><i data-lucide="paint-bucket" size="18"></i> 爪注</button>
        </div>

        <div id="view-catalog" class="flex-1 overflow-y-auto pb-32">
            <div id="productGrid" class="grid grid-cols-4 gap-6"></div>
        </div>

        <div id="view-calculator" class="hidden h-full flex items-center justify-center">
            <div class="bg-white p-12 rounded-[40px] shadow-2xl w-full max-w-3xl text-center">
                <h2 class="text-5xl font-black mb-8">砖 转</h2>
                <div class="grid grid-cols-2 gap-8 mb-8">
                    <input id="calcArea" type="number" placeholder="砖 (''专)" class="bg-gray-50 border-2 border-gray-100 p-6 rounded-2xl text-2xl font-bold outline-none focus:border-[#E3000F]">
                    <input id="calcConsumption" type="number" placeholder="爪专 (拽'' ''专)" class="bg-gray-50 border-2 border-gray-100 p-6 rounded-2xl text-2xl font-bold outline-none focus:border-[#E3000F]">
                </div>
                <div class="bg-black text-white p-8 rounded-3xl mb-8">
                    <div class="text-sm text-gray-400 uppercase font-bold tracking-widest mb-2">住" 专 专砖</div>
                    <div class="text-6xl font-black" id="resKg">0 <span class="text-2xl text-gray-500">拽"</span></div>
                </div>
                <button onclick="calculate()" class="bg-[#E3000F] text-white w-full py-5 rounded-2xl text-2xl font-black hover:bg-red-600 transition shadow-xl">爪注 砖</button>
            </div>
        </div>
    </main>

    <div id="sikaAiWrapper" class="state-corner">
        
        <div class="robot-character breathing-effect" onclick="triggerInteraction()">
            <img src="https://saban-kiosk-core.pages.dev/admin/sika-ai.png" class="w-full h-full object-contain">
            
            <div id="ctaBubble" class="absolute -top-10 right-10 bg-white px-5 py-3 rounded-2xl shadow-lg border-2 border-[#E3000F] whitespace-nowrap animate-bounce">
                <span class="font-black text-lg">爪专 注专? 抓 注!</span> 
            </div>
        </div>

        <div id="aiWindow">
            <div class="bg-[#111] p-4 text-white flex justify-between items-center shrink-0">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-[#FFC500] rounded-full flex items-center justify-center text-black font-bold border-2 border-white">Ai</div>
                    <span class="font-bold">Sika Expert</span>
                </div>
                <button onclick="event.stopPropagation(); closeInteraction()" class="hover:text-red-500"><i data-lucide="x"></i></button>
            </div>

            <div class="flex-1 p-6 overflow-y-auto relative flex flex-col">
                
                <div id="leadForm" class="flex flex-col h-full justify-center text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600"><i data-lucide="message-circle" size="32"></i></div>
                    <h3 class="text-2xl font-black mb-2"> 转 祝! </h3>
                    <p class="text-gray-500 mb-6 text-sm"> "住拽-Ai". 转  砖 驻 砖  注  爪祝.</p>
                    
                    <input type="text" id="leadName" placeholder=" 拽专  ?" class="w-full bg-gray-50 border p-3 rounded-xl mb-3 font-bold focus:border-[#E3000F] outline-none">
                    <input type="tel" id="leadPhone" placeholder="住驻专 " class="w-full bg-gray-50 border p-3 rounded-xl mb-4 font-bold focus:border-[#E3000F] outline-none">
                    
                    <label class="flex items-start gap-2 text-xs text-gray-500 cursor-pointer mb-6 text-right bg-gray-50 p-2 rounded">
                        <input type="checkbox" id="marketingConsent" checked>
                        <span>砖专 拽转 注 砖拽 驻 拽爪注 . 住</span>
                    </label>

                    <button onclick="submitLead()" class="bg-[#E3000F] text-white w-full py-4 rounded-xl font-bold shadow-lg hover:bg-red-600 transition flex items-center justify-center gap-2">
                        , 住 砖! <i data-lucide="arrow-left"></i>
                    </button>
                </div>

                <div id="chatInterface" class="hidden h-full flex flex-col">
                    <div id="chatHistory" class="flex-1 space-y-4 overflow-y-auto pb-4 pr-2">
                        <div class="flex gap-3">
                            <div class="w-8 h-8 bg-gray-100 rounded-full flex-shrink-0 flex items-center justify-center"></div>
                            <div class="bg-gray-100 p-3 rounded-2xl rounded-tr-none text-sm text-gray-800">
                                 <span id="userNameInsert" class="font-bold"></span>!  祝 砖爪专驻转.<br>  注专  爪 爪专, 砖 转  驻转专 注.  注 驻专拽?
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-auto pt-2 border-t flex gap-2">
                        <input id="chatInput" type="text" placeholder="转 注..." class="flex-1 bg-gray-50 border p-3 rounded-xl outline-none focus:border-[#E3000F]">
                        <button onclick="sendMessage()" class="bg-[#111] text-white p-3 rounded-xl"><i data-lucide="send"></i></button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="productModal" class="modal-overlay">
        <div class="modal-content relative flex">
            <button onclick="closeModal()" class="absolute top-6 left-6 z-20 bg-gray-100 p-3 rounded-full hover:bg-gray-200"><i data-lucide="x" size="24"></i></button>
            <div class="w-[40%] bg-gray-50 p-10 flex flex-col items-center justify-center border-l border-gray-100">
                <img id="mImage" src="" class="max-h-[400px] max-w-full object-contain mix-blend-multiply transition duration-500 hover:scale-105">
            </div>
            <div class="w-[60%] p-12 overflow-y-auto bg-white flex flex-col">
                <div class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2" id="mBrand">BRAND</div>
                <h2 class="text-5xl font-black mb-6 text-gray-900 leading-tight" id="mName">砖 爪专</h2>
                <div class="bg-yellow-50 p-6 rounded-2xl border-r-4 border-[#E3000F] mb-8"><p id="mDesc" class="text-xl leading-relaxed text-gray-800"></p></div>
                
                <div class="grid grid-cols-3 gap-4 mb-8">
                    <div class="tech-badge"><i data-lucide="maximize" class="text-blue-500 mb-1"></i><span class="tech-label">住</span><span class="tech-val" id="mCov">-</span></div>
                    <div class="tech-badge"><i data-lucide="clock" class="text-blue-500 mb-1"></i><span class="tech-label">砖</span><span class="tech-val" id="mDry">-</span></div>
                    <div class="tech-badge"><i data-lucide="layers" class="text-blue-500 mb-1"></i><span class="tech-label">注</span><span class="tech-val" id="mThick">-</span></div>
                </div>

                <div class="mt-auto pt-6 border-t flex gap-4">
                    <button onclick="openSmartCalc()" class="flex-1 bg-white border-2 border-gray-200 text-gray-800 font-bold py-4 rounded-xl hover:border-[#E3000F]">砖</button>
                    <button onclick="closeModal(); triggerInteraction()" class="flex-[2] bg-[#111] text-white font-bold py-4 rounded-xl shadow-xl flex items-center justify-center gap-2"><i data-lucide="bot"></i> 转注抓 注 Sika AI</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        
        // --- DATA ---
        const products = [
            { id: 1, name: "Sika TopSeal 107", brand: "SIKA", desc: " 爪 砖 专 专.", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR_u2_Yq_y_y_y_y_y_y_y_y_y_y_y_y", tech: {cov: "1.5 拽\"", dry: "6 砖注转", thick: "2 \""} },
            { id: 2, name: "Sikaflex 11FC+", brand: "SIKA", desc: "拽  驻专 专 转转.", image: "https://placehold.co/400?text=Sikaflex", tech: {cov: "砖转", dry: "24 砖注转", thick: "-"} },
            { id: 3, name: "Thermokir 603", brand: "THERMOKIR", desc: " 转专  注.", image: "https://placehold.co/400?text=Thermo+603", tech: {cov: "14 拽\"", dry: "48 砖注转", thick: "30 \""} },
            { id: 4, name: "Mister Fix 109", brand: "MISTER FIX", desc: "拽 拽专 专.", image: "https://placehold.co/400?text=Glue+109", tech: {cov: "5 拽\"", dry: "24 砖注转", thick: "5 \""} }
        ];
        
        let currentProduct = null;

        // --- INIT ---
        function init() {
            renderGrid(products);
        }

        // --- ROBOT INTERACTION LOGIC ---
        function triggerInteraction() {
            const wrapper = document.getElementById('sikaAiWrapper');
            const bubble = document.getElementById('ctaBubble');
            
            // 1. Hide bubble
            bubble.style.opacity = '0';
            
            // 2. Move to Center for Lead Form
            wrapper.classList.remove('state-corner');
            wrapper.classList.remove('state-chat-active');
            wrapper.classList.add('state-lead');
        }

        function closeInteraction() {
            const wrapper = document.getElementById('sikaAiWrapper');
            const bubble = document.getElementById('ctaBubble');
            
            // Reset to corner
            wrapper.classList.remove('state-lead');
            wrapper.classList.remove('state-chat-active');
            wrapper.classList.add('state-corner');
            
            // Show bubble
            setTimeout(() => bubble.style.opacity = '1', 800);
            
            // Reset views
            setTimeout(() => {
                document.getElementById('leadForm').classList.remove('hidden');
                document.getElementById('chatInterface').classList.add('hidden');
            }, 600);
        }

        function submitLead() {
            const name = document.getElementById('leadName').value;
            const phone = document.getElementById('leadPhone').value;
            const consent = document.getElementById('marketingConsent').checked;
            
            if(!name || !phone) return alert(", 转 砖 驻 砖砖  转 !");
            if(!consent) return alert(" 砖专 拽转 注 ( 拽...)");
            
            // --- ANIMATION: LEAD -> CHAT ---
            const wrapper = document.getElementById('sikaAiWrapper');
            
            // 1. Change State ( 转拽 拽专)
            wrapper.classList.remove('state-lead');
            wrapper.classList.add('state-chat-active'); //  驻注 转 -CSS 转拽
            
            // 2. Switch Content
            document.getElementById('leadForm').classList.add('hidden');
            document.getElementById('chatInterface').classList.remove('hidden');
            document.getElementById('chatInterface').classList.add('flex');
            
            // 3. Update Name
            document.getElementById('userNameInsert').innerText = name;
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value;
            if(!text) return;
            
            const history = document.getElementById('chatHistory');
            history.innerHTML += `
                <div class="flex justify-end">
                    <div class="bg-black text-white p-3 rounded-2xl rounded-br-none max-w-[80%] text-sm">${text}</div>
                </div>`;
            input.value = "";
            history.scrollTop = history.scrollHeight;
            
            // Simulate AI Reply
            setTimeout(() => {
                history.innerHTML += `
                    <div class="flex gap-3">
                        <div class="w-8 h-8 bg-gray-100 rounded-full flex-shrink-0 flex items-center justify-center"></div>
                        <div class="bg-gray-100 p-3 rounded-2xl rounded-tr-none text-sm text-gray-800 max-w-[80%]">
                             拽 转 ... ( 专  -AI)
                        </div>
                    </div>`;
                history.scrollTop = history.scrollHeight;
            }, 1000);
        }

        // --- CATALOG & TOOLS ---
        function renderGrid(list) {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = list.map(p => `
                <div onclick="openProduct(${p.id})" class="product-card group bg-white rounded-3xl p-4 shadow-sm hover:shadow-xl transition border border-transparent hover:border-blue-500 cursor-pointer h-72 flex flex-col">
                    <div class="h-1/2 flex items-center justify-center">
                        <img src="${p.image}" class="max-h-full max-w-full object-contain mix-blend-multiply group-hover:scale-110 transition">
                    </div>
                    <div class="mt-4">
                        <div class="text-xs text-gray-400 font-bold tracking-widest uppercase">${p.brand}</div>
                        <h3 class="text-lg font-bold text-gray-900 leading-tight">${p.name}</h3>
                    </div>
                </div>
            `).join('');
        }

        window.openProduct = (id) => {
            const p = products.find(x => x.id === id);
            currentProduct = p;
            document.getElementById('mName').innerText = p.name;
            document.getElementById('mDesc').innerText = p.desc;
            document.getElementById('mImage').src = p.image;
            document.getElementById('mBrand').innerText = p.brand;
            document.getElementById('mCov').innerText = p.tech.cov;
            document.getElementById('mDry').innerText = p.tech.dry;
            document.getElementById('mThick').innerText = p.tech.thick;
            document.getElementById('productModal').classList.add('open');
        }

        window.closeModal = () => document.getElementById('productModal').classList.remove('open');

        window.openSmartCalc = () => {
            closeModal();
            switchTab('calculator');
        }

        window.calculate = () => {
            const area = document.getElementById('calcArea').value;
            const cons = document.getElementById('calcConsumption').value;
            if(area && cons) document.getElementById('resKg').innerHTML = (area * cons).toFixed(1) + ' <span class="text-2xl text-gray-500">拽"</span>';
        }

        window.switchTab = (tab) => {
            document.querySelectorAll('.sidebar-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-'+tab).classList.add('active');
            if(tab === 'catalog') {
                document.getElementById('view-catalog').classList.remove('hidden');
                document.getElementById('view-calculator').classList.add('hidden');
            } else {
                document.getElementById('view-catalog').classList.add('hidden');
                document.getElementById('view-calculator').classList.remove('hidden');
                document.getElementById('view-calculator').classList.add('flex');
            }
        }

        window.filterProducts = () => {
            const term = document.getElementById('searchInput').value.toLowerCase();
            renderGrid(products.filter(p => p.name.toLowerCase().includes(term)));
        }

        init();
    </script>
</body>
</html>
